{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"84-3c5b7mLPS"},"outputs":[],"source":["import matplotlib.pyplot as plt\n","import numpy as np\n","import scipy.stats as stats\n","import math\n","\n","density = 100\n","\n","def generate_gaussian():\n","    mu = np.random.uniform(low=5,high=10)\n","    variance = 1\n","    sigma = math.sqrt(variance)\n","    x = np.linspace(mu - 3*sigma, mu + 3*sigma, 25)\n","    y = stats.norm.pdf(x, mu, sigma) * 50\n","\n","\n","    pref_x = np.array(range(density))\n","    new_y = np.interp(pref_x,x,y)\n","\n","    new_y += np.random.uniform(low=0,high=2,size=(density,))\n","\n","    return (pref_x,new_y)\n","\n","\n","\n","def f(x,a,tau):\n","    return a * np.exp(-x/tau)\n","\n","\n","def generate_decay_curve(high=5,tau_high=50):\n","    a = np.random.uniform(low=0.1,high=high)\n","    tau = np.random.uniform(low=1,high=tau_high)\n","    x = np.array(range(density))\n","    y = f(x,a,tau)\n","\n","    return (y,a,tau)\n","    \n","\n","def generate_dataset_one():\n","    (x,y) = generate_gaussian()\n","    (dec_y,a,t) = generate_decay_curve(high=20)\n","    z = np.convolve(y,dec_y)[:density]\n","    z += np.random.uniform(0,0.2)\n","\n","    input = np.concatenate((z,y))\n","    output = np.array((a,t,0,0,0,0))\n","\n","    return (input,output)"]},{"cell_type":"code","source":["def generate_dataset_two():\n","    (x,y) = generate_gaussian()\n","    \n","    (dec_y,a,t) = generate_decay_curve(high=5)\n","    (dec_y_2,a2,t2) = generate_decay_curve(high=5)\n","\n","    new_dec = dec_y + dec_y_2\n","\n","    z = np.convolve(y,new_dec)[:density]\n","    z += np.random.uniform(0,0.2)\n","\n","    input = np.concatenate((z,y))\n","    output = np.array((a,t,a2,t2,0,0))\n","    output = np.array(sorted([[a,t],[a2,t2],[a3,t3]]))\n","    output = output.reshape(6)\n","\n","    return (input,output)"],"metadata":{"id":"lPzB6AjSW1u9"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def generate_dataset_three():\n","    (x,y) = generate_gaussian()\n","    (dec_y,a,t) = generate_decay_curve(high=5)\n","    (dec_y_2,a2,t2) = generate_decay_curve(high=5)\n","    (dec_y_3,a3,t3) = generate_decay_curve(high=5)\n","\n","    new_dec = dec_y + dec_y_2 + dec_y_3\n","\n","    z = np.convolve(y,new_dec)[:density]\n","    z += np.random.uniform(0,0.2)\n","\n","    input = np.concatenate((z,y))\n","    output = np.array(sorted([[a,t],[a2,t2],[a3,t3]]))\n","    output = np.array([output[0][0],output[1][0],output[2][0],output[0][1],output[1][1],output[2][1]])\n","    # output = output.reshape(6)\n","\n","    return (input,output)"],"metadata":{"id":"Q9y1bMKtXy22"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EbR3K0p8mUF8"},"outputs":[],"source":["\"\"\n","x_list = []\n","y_list = []\n","for i in range(100000):\n","\n","    np.random\n","  \n","    # (x,y) = generate_dataset_one()\n","    \n","    # x_list.append(x)\n","    # y_list.append(y)\n","\n","    (x,y) = generate_dataset_three()\n","\n","    \n","    \n","    x_list.append(x)\n","    y_list.append(y)\n","\n","    # (x,y) = generate_dataset_three()\n","    \n","    # x_list.append(x)\n","    # y_list.append(y)\n","\n"]},{"cell_type":"code","source":["print(y_list[0])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"PCLMVIBvxt_B","executionInfo":{"status":"ok","timestamp":1644162159881,"user_tz":0,"elapsed":33,"user":{"displayName":"Madhan Rajan","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11949160929832065290"}},"outputId":"1215f287-c403-44fa-d4df-59a24e8b741a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[ 0.98354544  1.58338211  2.82072398 39.69927467 22.04120052 25.45812659]\n"]}]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":282},"executionInfo":{"elapsed":3709,"status":"ok","timestamp":1644162163565,"user":{"displayName":"Madhan Rajan","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11949160929832065290"},"user_tz":0},"id":"hbgNkuaAm4RA","outputId":"2378924c-ad40-432b-9f5a-8c8374d5a668"},"outputs":[{"output_type":"stream","name":"stdout","text":["1.34157978032841 4.590728801314046 5.6228638419527925\n"]},{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"needs_background":"light"}}],"source":["import tensorflow as tf\n","from sklearn.model_selection import train_test_split\n","import sklearn\n","\n","x_list = np.array(x_list)\n","y_list = np.array(y_list)\n","\n","\n","# x_list = np.log(x_list)\n","\n","x_list, y_list = sklearn.utils.shuffle(x_list,y_list)\n","\n","\n","import matplotlib.pyplot as plt\n","\n","x = np.array(range(density))\n","plt.plot(x,x_list[0][:density])\n","plt.plot(x,x_list[0][density:])\n","\n","\n","a = y_list[0][0]\n","tau = y_list[0][1]\n","a2 = y_list[0][2]\n","tau2 = y_list[0][3]\n","a3 = y_list[0][4]\n","tau3 = y_list[0][5]\n","\n","print(a,a2,a3)\n","\n","\n","\n","plt.plot(x,f(x,a,tau))\n","plt.plot(x,f(x,a2,tau2))\n","# plt.plot(x,f(x,a3,tau3))\n","plt.show()\n","\n","\n"]},{"cell_type":"code","source":["\n","x_list = tf.keras.utils.normalize(x_list)\n","# y_list = tf.keras.utils.normalize(y_list)\n","\n","print(x_list.shape)\n","print(y_list.shape)\n","\n","\n","\n","\n","X_train, X_test, y_train, y_test = train_test_split(x_list, y_list, test_size=0.10, random_state=40)\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Khp6zsKhol2e","executionInfo":{"status":"ok","timestamp":1644162163892,"user_tz":0,"elapsed":335,"user":{"displayName":"Madhan Rajan","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11949160929832065290"}},"outputId":"e1f732e2-391b-4968-d331-5a679a49ecbd"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["(100000, 200)\n","(100000, 6)\n"]}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CPHyv5EymzWj"},"outputs":[],"source":["import keras\n","from tensorflow.keras.models import Sequential\n","from tensorflow.keras.layers import Dense, Dropout\n","from tensorflow.keras import layers\n","\n","\n","model = Sequential()\n","model.add(Dense(400, input_dim=density*2))\n","model.add(Dense(400, activation='relu'))\n","model.add(Dense(400, activation='relu'))\n","model.add(Dense(400, activation='relu'))\n","model.add(Dense(400, activation='relu'))\n","model.add(Dense(400, activation='relu'))\n","model.add(Dense(400, activation='relu'))\n","model.add(Dense(400, activation='relu'))\n","model.add(Dense(400, activation='relu'))\n","model.add(Dense(400, activation='relu'))\n","model.add(Dense(100, activation='relu'))\n","model.add(Dropout(0.5))\n","model.add(Dense(6, activation='relu'))"]},{"cell_type":"code","source":["def ftf(a,tau):\n","  return a*tf.math.exp(np.array(range(100))/tau)\n","\n","def error_function(y,y_real):\n","\n","  # a,tau = tf.split(y,num_or_size_of_splits=2,axis=1)\n","  # a_real,tau_real = tf.split(y,num_or_size_of_splits=2,axis=1)\n","\n","  return tf.math.reduce_sum(tf.math.abs(y-y_real))\n","\n"],"metadata":{"id":"yY5ay5zMXyP8"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"YPS1N9kGnRFI","outputId":"471073db-fce7-4157-eb77-efea70a60c99"},"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/50\n"," 51/563 [=>............................] - ETA: 42s - loss: 4194.3833 - accuracy: 0.4350"]}],"source":["model.compile(optimizer= tf.keras.optimizers.Adam(learning_rate=1e-5), loss=error_function, metrics=[\"accuracy\"])\n","model.fit(X_train, y_train, batch_size=128, epochs=50, validation_split=0.2)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-TYn_kpdp8Nl"},"outputs":[],"source":["model.evaluate(X_test,y_test)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dhTzzYJX3oRA","outputId":"af3010d8-cf8c-456b-cf11-b05a72ce3a36","executionInfo":{"status":"ok","timestamp":1644167314017,"user_tz":0,"elapsed":217,"user":{"displayName":"Madhan Rajan","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11949160929832065290"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["[array([ 1.73633243,  2.23933945,  4.0736737 , 36.50124891, 34.42196311,\n","       15.84378823]), array([ 0.24734773,  0.71135304,  2.0010057 , 31.0101722 , 37.39110255,\n","       16.62009306]), array([ 1.90859957,  2.99109321,  4.83655872, 25.59778822, 10.56052228,\n","        9.28153748]), array([ 1.89761325,  2.28309791,  4.32845286,  4.15569103, 42.34898057,\n","       35.26686074]), array([2.81320122, 3.85920437, 4.52001828, 8.90914724, 9.11148113,\n","       3.73098418])]\n"]}],"source":["m_list = []\n","n_list = []\n","for i in range(5):\n","  (m,n) = generate_dataset_three()\n","  m_list.append(m)\n","  n_list.append(n)\n","\n","\n","m = np.array(m_list)\n","m = tf.keras.utils.normalize(m)\n","# m = np.log(m)\n","n = np.array(n_list)\n","\n","print(n_list)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"aVo1WPRf35zp","executionInfo":{"status":"ok","timestamp":1644167315543,"user_tz":0,"elapsed":307,"user":{"displayName":"Madhan Rajan","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11949160929832065290"}},"outputId":"3ccff091-e44b-4c4e-cee3-e9bb5b01d96c"},"outputs":[{"output_type":"stream","name":"stdout","text":["[[ 0.         2.4122715  3.5448198 24.123642  23.734653  23.775335 ]\n"," [ 0.         2.3986955  3.4923525 23.16623   21.442781  20.195864 ]\n"," [ 0.         2.2934034  3.5657656 16.385818  12.755271  11.840083 ]\n"," [ 0.         2.3318007  3.5338047 24.172956  24.629015  30.16051  ]\n"," [ 0.         2.272164   3.6275055 14.467089   8.377192   6.0165944]]\n"]}],"source":["\n","pred_n = model.predict(m)\n","print(pred_n)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"XeRYfRbZ4A4N"},"outputs":[],"source":["n_ = np.absolute(pred_n-n)/ n\n","\n","N_ = 1 - n_\n","\n","print(np.average(N_, axis=0))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"e0U6sNll8yw5"},"outputs":[],"source":["model.save(\"mymodel\")"]}],"metadata":{"accelerator":"TPU","colab":{"collapsed_sections":[],"name":"3setsofdata","provenance":[{"file_id":"1g1Lfc54hLeV-o7TRP7poHzXNGNCkWoBO","timestamp":1643579564167},{"file_id":"1d2bsw8hKS6LZCLOTy-u_0eiVvaFSznbd","timestamp":1643569030471}],"authorship_tag":"ABX9TyMF1gckn/jDw6BAkTtv0SWz"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}