{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"id":"84-3c5b7mLPS","executionInfo":{"status":"ok","timestamp":1643579606966,"user_tz":0,"elapsed":517,"user":{"displayName":"Madhan Rajan","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11949160929832065290"}}},"outputs":[],"source":["import matplotlib.pyplot as plt\n","import numpy as np\n","import scipy.stats as stats\n","import math\n","\n","density = 100\n","\n","def generate_gaussian():\n","    mu = np.random.uniform(low=5,high=10)\n","    variance = 1\n","    sigma = math.sqrt(variance)\n","    x = np.linspace(mu - 3*sigma, mu + 3*sigma, 25)\n","    y = stats.norm.pdf(x, mu, sigma) * 50\n","\n","\n","    pref_x = np.array(range(density))\n","    new_y = np.interp(pref_x,x,y)\n","\n","    new_y += np.random.uniform(low=0,high=2,size=(density,))\n","\n","    return (pref_x,new_y)\n","\n","\n","\n","def f(x,a,tau):\n","    return a * np.exp(-x/tau)\n","\n","\n","def generate_decay_curve(high=5):\n","    a = np.random.uniform(low=0.1,high=high)\n","    tau = np.random.uniform(low=1,high=50)\n","    x = np.array(range(density))\n","    y = f(x,a,tau)\n","\n","    return (y,a,tau)\n","    \n","\n","def generate_dataset_one():\n","    (x,y) = generate_gaussian()\n","    (dec_y,a,t) = generate_decay_curve(high=20)\n","    z = np.convolve(y,dec_y)[:density]\n","    z += np.random.uniform(0,0.2)\n","\n","    input = np.concatenate((z,y))\n","    output = np.array((a,t,0,0,0,0))\n","\n","    return (input,output)"]},{"cell_type":"code","source":["def generate_dataset_two():\n","    (x,y) = generate_gaussian()\n","    \n","    (dec_y,a,t) = generate_decay_curve(high=5)\n","    (dec_y_2,a2,t2) = generate_decay_curve(high=5)\n","\n","    new_dec = dec_y + dec_y_2\n","\n","    z = np.convolve(y,new_dec)[:density]\n","    z += np.random.uniform(0,0.2)\n","\n","    input = np.concatenate((z,y))\n","    output = np.array((a,t,a2,t2,0,0))\n","\n","    return (input,output)"],"metadata":{"id":"lPzB6AjSW1u9","executionInfo":{"status":"ok","timestamp":1643579606967,"user_tz":0,"elapsed":10,"user":{"displayName":"Madhan Rajan","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11949160929832065290"}}},"execution_count":2,"outputs":[]},{"cell_type":"code","source":["def generate_dataset_three():\n","    (x,y) = generate_gaussian()\n","    (dec_y,a,t) = generate_decay_curve(high=5)\n","    (dec_y_2,a2,t2) = generate_decay_curve(high=5)\n","    (dec_y_3,a3,t3) = generate_decay_curve(high=5)\n","\n","    new_dec = dec_y + dec_y_2 + dec_y_3\n","\n","    z = np.convolve(y,new_dec)[:density]\n","    z += np.random.uniform(0,0.2)\n","\n","    input = np.concatenate((z,y))\n","    output = np.array((a,t,a2,t2,a3,t3))\n","\n","    return (input,output)"],"metadata":{"id":"Q9y1bMKtXy22","executionInfo":{"status":"ok","timestamp":1643579606968,"user_tz":0,"elapsed":7,"user":{"displayName":"Madhan Rajan","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11949160929832065290"}}},"execution_count":3,"outputs":[]},{"cell_type":"code","execution_count":4,"metadata":{"id":"EbR3K0p8mUF8","executionInfo":{"status":"ok","timestamp":1643579662893,"user_tz":0,"elapsed":55931,"user":{"displayName":"Madhan Rajan","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11949160929832065290"}}},"outputs":[],"source":["\"\"\n","x_list = []\n","y_list = []\n","for i in range(100000):\n","  \n","    # (x,y) = generate_dataset_one()\n","    \n","    # x_list.append(x)\n","    # y_list.append(y)\n","\n","    (x,y) = generate_dataset_three()\n","    \n","    x_list.append(x)\n","    y_list.append(y)\n","\n","    # (x,y) = generate_dataset_three()\n","    \n","    # x_list.append(x)\n","    # y_list.append(y)\n","\n"]},{"cell_type":"code","execution_count":5,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":265},"executionInfo":{"elapsed":3322,"status":"ok","timestamp":1643579666208,"user":{"displayName":"Madhan Rajan","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11949160929832065290"},"user_tz":0},"id":"hbgNkuaAm4RA","outputId":"6cda82b8-5db6-4134-b6d9-d703f2df4545"},"outputs":[{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"needs_background":"light"}}],"source":["import tensorflow as tf\n","from sklearn.model_selection import train_test_split\n","import sklearn\n","\n","x_list = np.array(x_list)\n","y_list = np.array(y_list)\n","\n","x_list, y_list = sklearn.utils.shuffle(x_list,y_list)\n","\n","\n","import matplotlib.pyplot as plt\n","\n","x = np.array(range(density))\n","plt.plot(x,x_list[0][:density])\n","plt.plot(x,x_list[0][density:])\n","\n","\n","a = y_list[2][0]\n","tau = y_list[2][1]\n","a2 = y_list[2][2]\n","tau2 = y_list[2][3]\n","a3 = y_list[2][4]\n","tau3 = y_list[2][5]\n","\n","\n","\n","\n","\n","plt.plot(x,f(x,a,tau))\n","plt.plot(x,f(x,a2,tau2))\n","# plt.plot(x,f(x,a3,tau3))\n","plt.show()\n","\n","\n"]},{"cell_type":"code","source":["\n","x_list = tf.keras.utils.normalize(x_list)\n","# y_list = tf.keras.utils.normalize(y_list)\n","\n","print(x_list.shape)\n","print(y_list.shape)\n","\n","\n","\n","\n","X_train, X_test, y_train, y_test = train_test_split(x_list, y_list, test_size=0.10, random_state=40)\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Khp6zsKhol2e","executionInfo":{"status":"ok","timestamp":1643579666457,"user_tz":0,"elapsed":253,"user":{"displayName":"Madhan Rajan","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11949160929832065290"}},"outputId":"2235fb1d-acba-405c-fdb2-43859df3e711"},"execution_count":6,"outputs":[{"output_type":"stream","name":"stdout","text":["(100000, 200)\n","(100000, 6)\n"]}]},{"cell_type":"code","execution_count":9,"metadata":{"id":"CPHyv5EymzWj","executionInfo":{"status":"ok","timestamp":1643579741953,"user_tz":0,"elapsed":553,"user":{"displayName":"Madhan Rajan","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11949160929832065290"}}},"outputs":[],"source":["import keras\n","from tensorflow.keras.models import Sequential\n","from tensorflow.keras.layers import Dense\n","from tensorflow.keras import layers\n","\n","\n","model = Sequential()\n","model.add(Dense(400, activation='relu', input_dim=density*2))\n","model.add(Dense(400, activation='relu'))\n","model.add(Dense(400, activation='relu'))\n","model.add(Dense(400, activation='relu'))\n","model.add(Dense(400, activation='relu'))\n","model.add(Dense(400, activation='relu'))\n","model.add(Dense(400, activation='relu'))\n","model.add(Dense(400, activation='relu'))\n","model.add(Dense(6, activation='relu'))"]},{"cell_type":"code","execution_count":10,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"YPS1N9kGnRFI","outputId":"85b64af5-43db-43b5-8158-ccfce23b6537","executionInfo":{"status":"ok","timestamp":1643581627807,"user_tz":0,"elapsed":1884738,"user":{"displayName":"Madhan Rajan","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11949160929832065290"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/100\n","563/563 [==============================] - 36s 60ms/step - loss: 243.8439 - accuracy: 0.3232 - val_loss: 98.0651 - val_accuracy: 0.3338\n","Epoch 2/100\n","563/563 [==============================] - 18s 32ms/step - loss: 97.0981 - accuracy: 0.3320 - val_loss: 82.9339 - val_accuracy: 0.3295\n","Epoch 3/100\n","563/563 [==============================] - 18s 32ms/step - loss: 88.2812 - accuracy: 0.3325 - val_loss: 80.9211 - val_accuracy: 0.3362\n","Epoch 4/100\n","563/563 [==============================] - 18s 32ms/step - loss: 86.7556 - accuracy: 0.3350 - val_loss: 80.2121 - val_accuracy: 0.3337\n","Epoch 5/100\n","563/563 [==============================] - 18s 32ms/step - loss: 85.8883 - accuracy: 0.3318 - val_loss: 79.6291 - val_accuracy: 0.3331\n","Epoch 6/100\n","563/563 [==============================] - 20s 35ms/step - loss: 85.3830 - accuracy: 0.3321 - val_loss: 78.8513 - val_accuracy: 0.3288\n","Epoch 7/100\n","563/563 [==============================] - 19s 33ms/step - loss: 84.8891 - accuracy: 0.3351 - val_loss: 78.6390 - val_accuracy: 0.3391\n","Epoch 8/100\n","563/563 [==============================] - 18s 32ms/step - loss: 84.6024 - accuracy: 0.3325 - val_loss: 78.3349 - val_accuracy: 0.3354\n","Epoch 9/100\n","563/563 [==============================] - 18s 32ms/step - loss: 84.2353 - accuracy: 0.3326 - val_loss: 78.2182 - val_accuracy: 0.3358\n","Epoch 10/100\n","563/563 [==============================] - 18s 32ms/step - loss: 83.9814 - accuracy: 0.3339 - val_loss: 77.6980 - val_accuracy: 0.3342\n","Epoch 11/100\n","563/563 [==============================] - 18s 32ms/step - loss: 83.6698 - accuracy: 0.3296 - val_loss: 77.3996 - val_accuracy: 0.3383\n","Epoch 12/100\n","563/563 [==============================] - 18s 32ms/step - loss: 83.1991 - accuracy: 0.3356 - val_loss: 77.3223 - val_accuracy: 0.3295\n","Epoch 13/100\n","563/563 [==============================] - 18s 32ms/step - loss: 82.9368 - accuracy: 0.3346 - val_loss: 77.0643 - val_accuracy: 0.3359\n","Epoch 14/100\n","563/563 [==============================] - 18s 32ms/step - loss: 82.6980 - accuracy: 0.3358 - val_loss: 76.9262 - val_accuracy: 0.3352\n","Epoch 15/100\n","563/563 [==============================] - 18s 32ms/step - loss: 82.3852 - accuracy: 0.3351 - val_loss: 77.0706 - val_accuracy: 0.3363\n","Epoch 16/100\n","563/563 [==============================] - 18s 32ms/step - loss: 82.2149 - accuracy: 0.3367 - val_loss: 76.7008 - val_accuracy: 0.3336\n","Epoch 17/100\n","563/563 [==============================] - 18s 32ms/step - loss: 82.1080 - accuracy: 0.3313 - val_loss: 76.6172 - val_accuracy: 0.3357\n","Epoch 18/100\n","563/563 [==============================] - 18s 32ms/step - loss: 81.7875 - accuracy: 0.3314 - val_loss: 76.9321 - val_accuracy: 0.3343\n","Epoch 19/100\n","563/563 [==============================] - 18s 32ms/step - loss: 81.5898 - accuracy: 0.3316 - val_loss: 76.5037 - val_accuracy: 0.3264\n","Epoch 20/100\n","563/563 [==============================] - 18s 32ms/step - loss: 81.3651 - accuracy: 0.3341 - val_loss: 76.4980 - val_accuracy: 0.3295\n","Epoch 21/100\n","563/563 [==============================] - 18s 32ms/step - loss: 81.2104 - accuracy: 0.3329 - val_loss: 76.3719 - val_accuracy: 0.3332\n","Epoch 22/100\n","563/563 [==============================] - 18s 32ms/step - loss: 81.0003 - accuracy: 0.3305 - val_loss: 76.2485 - val_accuracy: 0.3338\n","Epoch 23/100\n","563/563 [==============================] - 18s 32ms/step - loss: 80.7940 - accuracy: 0.3359 - val_loss: 76.5929 - val_accuracy: 0.3295\n","Epoch 24/100\n","563/563 [==============================] - 18s 32ms/step - loss: 80.6166 - accuracy: 0.3353 - val_loss: 76.1386 - val_accuracy: 0.3336\n","Epoch 25/100\n","563/563 [==============================] - 18s 32ms/step - loss: 80.4747 - accuracy: 0.3318 - val_loss: 76.5726 - val_accuracy: 0.3341\n","Epoch 26/100\n","563/563 [==============================] - 18s 32ms/step - loss: 80.4501 - accuracy: 0.3302 - val_loss: 76.1350 - val_accuracy: 0.3342\n","Epoch 27/100\n","563/563 [==============================] - 18s 32ms/step - loss: 80.2698 - accuracy: 0.3324 - val_loss: 76.0175 - val_accuracy: 0.3353\n","Epoch 28/100\n","563/563 [==============================] - 20s 35ms/step - loss: 80.1205 - accuracy: 0.3322 - val_loss: 75.9114 - val_accuracy: 0.3346\n","Epoch 29/100\n","563/563 [==============================] - 18s 32ms/step - loss: 79.8879 - accuracy: 0.3321 - val_loss: 76.1109 - val_accuracy: 0.3348\n","Epoch 30/100\n","563/563 [==============================] - 18s 32ms/step - loss: 79.7990 - accuracy: 0.3348 - val_loss: 75.9070 - val_accuracy: 0.3340\n","Epoch 31/100\n","563/563 [==============================] - 18s 32ms/step - loss: 79.5642 - accuracy: 0.3346 - val_loss: 75.7689 - val_accuracy: 0.3376\n","Epoch 32/100\n","563/563 [==============================] - 18s 32ms/step - loss: 79.6279 - accuracy: 0.3314 - val_loss: 75.7421 - val_accuracy: 0.3399\n","Epoch 33/100\n","563/563 [==============================] - 18s 32ms/step - loss: 79.3847 - accuracy: 0.3337 - val_loss: 75.8687 - val_accuracy: 0.3340\n","Epoch 34/100\n","563/563 [==============================] - 18s 32ms/step - loss: 79.3949 - accuracy: 0.3327 - val_loss: 75.6724 - val_accuracy: 0.3346\n","Epoch 35/100\n","563/563 [==============================] - 18s 32ms/step - loss: 79.2559 - accuracy: 0.3333 - val_loss: 75.6858 - val_accuracy: 0.3335\n","Epoch 36/100\n","563/563 [==============================] - 18s 32ms/step - loss: 79.1075 - accuracy: 0.3336 - val_loss: 75.6339 - val_accuracy: 0.3362\n","Epoch 37/100\n","563/563 [==============================] - 18s 32ms/step - loss: 79.0941 - accuracy: 0.3329 - val_loss: 75.6305 - val_accuracy: 0.3318\n","Epoch 38/100\n","563/563 [==============================] - 18s 32ms/step - loss: 79.1541 - accuracy: 0.3329 - val_loss: 75.6184 - val_accuracy: 0.3337\n","Epoch 39/100\n","563/563 [==============================] - 18s 32ms/step - loss: 79.0725 - accuracy: 0.3327 - val_loss: 75.6407 - val_accuracy: 0.3338\n","Epoch 40/100\n","563/563 [==============================] - 18s 32ms/step - loss: 79.0899 - accuracy: 0.3309 - val_loss: 75.6018 - val_accuracy: 0.3346\n","Epoch 41/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.9395 - accuracy: 0.3322 - val_loss: 75.5349 - val_accuracy: 0.3281\n","Epoch 42/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.7604 - accuracy: 0.3351 - val_loss: 75.6120 - val_accuracy: 0.3293\n","Epoch 43/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.9014 - accuracy: 0.3317 - val_loss: 75.6767 - val_accuracy: 0.3329\n","Epoch 44/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.6687 - accuracy: 0.3351 - val_loss: 75.4851 - val_accuracy: 0.3326\n","Epoch 45/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.7299 - accuracy: 0.3328 - val_loss: 75.4369 - val_accuracy: 0.3331\n","Epoch 46/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.6117 - accuracy: 0.3332 - val_loss: 75.5311 - val_accuracy: 0.3339\n","Epoch 47/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.5917 - accuracy: 0.3340 - val_loss: 75.8429 - val_accuracy: 0.3388\n","Epoch 48/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.6006 - accuracy: 0.3351 - val_loss: 75.6284 - val_accuracy: 0.3347\n","Epoch 49/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.5308 - accuracy: 0.3324 - val_loss: 75.4740 - val_accuracy: 0.3317\n","Epoch 50/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.5511 - accuracy: 0.3311 - val_loss: 75.3636 - val_accuracy: 0.3328\n","Epoch 51/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.4852 - accuracy: 0.3330 - val_loss: 75.3332 - val_accuracy: 0.3352\n","Epoch 52/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.3331 - accuracy: 0.3344 - val_loss: 75.3737 - val_accuracy: 0.3328\n","Epoch 53/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.3263 - accuracy: 0.3333 - val_loss: 75.4614 - val_accuracy: 0.3359\n","Epoch 54/100\n","563/563 [==============================] - 18s 33ms/step - loss: 78.2990 - accuracy: 0.3314 - val_loss: 75.7641 - val_accuracy: 0.3347\n","Epoch 55/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.3488 - accuracy: 0.3319 - val_loss: 75.4161 - val_accuracy: 0.3331\n","Epoch 56/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.2725 - accuracy: 0.3347 - val_loss: 75.3480 - val_accuracy: 0.3360\n","Epoch 57/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.1917 - accuracy: 0.3339 - val_loss: 75.3404 - val_accuracy: 0.3336\n","Epoch 58/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.2301 - accuracy: 0.3379 - val_loss: 75.3993 - val_accuracy: 0.3328\n","Epoch 59/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.1808 - accuracy: 0.3306 - val_loss: 75.2428 - val_accuracy: 0.3350\n","Epoch 60/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.2368 - accuracy: 0.3343 - val_loss: 75.3672 - val_accuracy: 0.3333\n","Epoch 61/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.1091 - accuracy: 0.3372 - val_loss: 75.2987 - val_accuracy: 0.3333\n","Epoch 62/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.1322 - accuracy: 0.3337 - val_loss: 75.2284 - val_accuracy: 0.3378\n","Epoch 63/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.1069 - accuracy: 0.3320 - val_loss: 75.2336 - val_accuracy: 0.3362\n","Epoch 64/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.0422 - accuracy: 0.3341 - val_loss: 76.1877 - val_accuracy: 0.3336\n","Epoch 65/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.9921 - accuracy: 0.3336 - val_loss: 75.2102 - val_accuracy: 0.3327\n","Epoch 66/100\n","563/563 [==============================] - 18s 32ms/step - loss: 78.0540 - accuracy: 0.3322 - val_loss: 75.2222 - val_accuracy: 0.3366\n","Epoch 67/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.9548 - accuracy: 0.3339 - val_loss: 75.1676 - val_accuracy: 0.3349\n","Epoch 68/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.9126 - accuracy: 0.3329 - val_loss: 75.6003 - val_accuracy: 0.3295\n","Epoch 69/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.9883 - accuracy: 0.3312 - val_loss: 75.2295 - val_accuracy: 0.3366\n","Epoch 70/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.8514 - accuracy: 0.3334 - val_loss: 75.1809 - val_accuracy: 0.3351\n","Epoch 71/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.8254 - accuracy: 0.3332 - val_loss: 75.1448 - val_accuracy: 0.3341\n","Epoch 72/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.8897 - accuracy: 0.3338 - val_loss: 75.1963 - val_accuracy: 0.3342\n","Epoch 73/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.7925 - accuracy: 0.3323 - val_loss: 75.1243 - val_accuracy: 0.3335\n","Epoch 74/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.7619 - accuracy: 0.3315 - val_loss: 75.0881 - val_accuracy: 0.3337\n","Epoch 75/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.8924 - accuracy: 0.3322 - val_loss: 75.0960 - val_accuracy: 0.3364\n","Epoch 76/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.7722 - accuracy: 0.3333 - val_loss: 75.4082 - val_accuracy: 0.3292\n","Epoch 77/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.7512 - accuracy: 0.3308 - val_loss: 75.2719 - val_accuracy: 0.3357\n","Epoch 78/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.7178 - accuracy: 0.3343 - val_loss: 75.5023 - val_accuracy: 0.3349\n","Epoch 79/100\n","563/563 [==============================] - 18s 33ms/step - loss: 77.7722 - accuracy: 0.3332 - val_loss: 75.2094 - val_accuracy: 0.3304\n","Epoch 80/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.7506 - accuracy: 0.3316 - val_loss: 75.0587 - val_accuracy: 0.3339\n","Epoch 81/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.7319 - accuracy: 0.3339 - val_loss: 75.1042 - val_accuracy: 0.3355\n","Epoch 82/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.6369 - accuracy: 0.3338 - val_loss: 75.4257 - val_accuracy: 0.3335\n","Epoch 83/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.6716 - accuracy: 0.3336 - val_loss: 75.6558 - val_accuracy: 0.3358\n","Epoch 84/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.5920 - accuracy: 0.3392 - val_loss: 75.0272 - val_accuracy: 0.3334\n","Epoch 85/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.5863 - accuracy: 0.3338 - val_loss: 75.1255 - val_accuracy: 0.3352\n","Epoch 86/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.6052 - accuracy: 0.3293 - val_loss: 74.9867 - val_accuracy: 0.3356\n","Epoch 87/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.5867 - accuracy: 0.3329 - val_loss: 74.9784 - val_accuracy: 0.3340\n","Epoch 88/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.6200 - accuracy: 0.3321 - val_loss: 74.9520 - val_accuracy: 0.3347\n","Epoch 89/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.5108 - accuracy: 0.3353 - val_loss: 75.0442 - val_accuracy: 0.3342\n","Epoch 90/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.5135 - accuracy: 0.3319 - val_loss: 75.0281 - val_accuracy: 0.3363\n","Epoch 91/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.4704 - accuracy: 0.3316 - val_loss: 75.3085 - val_accuracy: 0.3299\n","Epoch 92/100\n","563/563 [==============================] - 22s 39ms/step - loss: 77.4719 - accuracy: 0.3307 - val_loss: 74.9894 - val_accuracy: 0.3354\n","Epoch 93/100\n","563/563 [==============================] - 21s 37ms/step - loss: 77.4447 - accuracy: 0.3358 - val_loss: 75.1817 - val_accuracy: 0.3314\n","Epoch 94/100\n","563/563 [==============================] - 18s 33ms/step - loss: 77.4533 - accuracy: 0.3322 - val_loss: 75.3372 - val_accuracy: 0.3366\n","Epoch 95/100\n","563/563 [==============================] - 18s 33ms/step - loss: 77.4253 - accuracy: 0.3312 - val_loss: 75.1452 - val_accuracy: 0.3357\n","Epoch 96/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.3321 - accuracy: 0.3377 - val_loss: 75.1189 - val_accuracy: 0.3369\n","Epoch 97/100\n","563/563 [==============================] - 18s 33ms/step - loss: 77.3055 - accuracy: 0.3360 - val_loss: 74.9044 - val_accuracy: 0.3328\n","Epoch 98/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.3451 - accuracy: 0.3309 - val_loss: 75.1904 - val_accuracy: 0.3346\n","Epoch 99/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.4288 - accuracy: 0.3332 - val_loss: 74.8961 - val_accuracy: 0.3367\n","Epoch 100/100\n","563/563 [==============================] - 18s 32ms/step - loss: 77.3921 - accuracy: 0.3328 - val_loss: 74.8660 - val_accuracy: 0.3357\n"]},{"output_type":"execute_result","data":{"text/plain":["<keras.callbacks.History at 0x7efd9b66d750>"]},"metadata":{},"execution_count":10}],"source":["model.compile(optimizer= tf.keras.optimizers.Adam(learning_rate=1e-5), loss='mean_squared_error', metrics=[\"accuracy\"])\n","model.fit(X_train, y_train, batch_size=128, epochs=100, validation_split=0.2)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-TYn_kpdp8Nl","executionInfo":{"status":"aborted","timestamp":1643579740549,"user_tz":0,"elapsed":8,"user":{"displayName":"Madhan Rajan","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11949160929832065290"}}},"outputs":[],"source":["model.evaluate(X_test,y_test)"]},{"cell_type":"code","execution_count":20,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dhTzzYJX3oRA","outputId":"42826cac-8d58-42b1-85e8-24438b4e35e0","executionInfo":{"status":"ok","timestamp":1643581820830,"user_tz":0,"elapsed":181,"user":{"displayName":"Madhan Rajan","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11949160929832065290"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["[array([ 2.11452693, 18.11990775,  3.33237724, 20.85847583,  1.96679633,\n","        4.91076749]), array([ 1.30791063, 48.67409933,  4.63632795, 12.71349333,  0.2476916 ,\n","       22.42318936])]\n"]}],"source":["m_list = []\n","n_list = []\n","for i in range(2):\n","  (m,n) = generate_dataset_three()\n","  m_list.append(m)\n","  n_list.append(n)\n","\n","\n","m = np.array(m_list)\n","m = tf.keras.utils.normalize(m)\n","n = np.array(n_list)\n","\n","print(n_list)"]},{"cell_type":"code","execution_count":21,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"aVo1WPRf35zp","executionInfo":{"status":"ok","timestamp":1643581822526,"user_tz":0,"elapsed":281,"user":{"displayName":"Madhan Rajan","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11949160929832065290"}},"outputId":"354c74bb-e567-46aa-9529-64020a4f8625"},"outputs":[{"output_type":"stream","name":"stdout","text":["[[ 3.1200793 14.629407   3.125448  14.736584   3.0829566 14.653926 ]\n"," [ 2.2922485 21.408304   2.29134   21.566278   2.3196762 21.546745 ]]\n"]}],"source":["\n","pred_n = model.predict(m)\n","print(pred_n)"]},{"cell_type":"code","execution_count":17,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"XeRYfRbZ4A4N","outputId":"5f72a6a5-21e8-4d82-dd7c-ce21ca0a1725","executionInfo":{"status":"ok","timestamp":1643581750673,"user_tz":0,"elapsed":192,"user":{"displayName":"Madhan Rajan","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11949160929832065290"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["[ 0.36593014  0.90415985  0.52924902  0.88050937 -1.09181143 -2.10983949]\n"]}],"source":["n_ = np.absolute(pred_n-n)/ n\n","\n","N_ = 1 - n_\n","\n","print(np.average(N_, axis=0))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"e0U6sNll8yw5","executionInfo":{"status":"aborted","timestamp":1643579740552,"user_tz":0,"elapsed":9,"user":{"displayName":"Madhan Rajan","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"11949160929832065290"}}},"outputs":[],"source":["model.save(\"mymodel\")"]}],"metadata":{"accelerator":"TPU","colab":{"collapsed_sections":[],"name":"Copy of 3setsofdata","provenance":[{"file_id":"1dzyDXFpzavCg-8beUBTlvDa9fQx2L-Aa","timestamp":1643581858280},{"file_id":"1g1Lfc54hLeV-o7TRP7poHzXNGNCkWoBO","timestamp":1643579564167},{"file_id":"1d2bsw8hKS6LZCLOTy-u_0eiVvaFSznbd","timestamp":1643569030471}],"authorship_tag":"ABX9TyN//MqA900Ioikm7PlbnH+W"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}